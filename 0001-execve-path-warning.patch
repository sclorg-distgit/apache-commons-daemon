From 0de57c78cbe1666fdf78ff6522b3b0ce18f12716 Mon Sep 17 00:00:00 2001
From: Stanislav Ochotnicky <sochotnicky@redhat.com>
Date: Tue, 18 Jan 2011 14:46:21 +0100
Subject: [PATCH 1/3] execve path warning

---
 src/native/unix/native/jsvc-unix.c |    9 +++++++++
 1 files changed, 9 insertions(+), 0 deletions(-)

diff --git a/src/native/unix/native/jsvc-unix.c b/src/native/unix/native/jsvc-unix.c
index 1967f09..22967f1 100644
--- a/src/native/unix/native/jsvc-unix.c
+++ b/src/native/unix/native/jsvc-unix.c
@@ -1015,6 +1015,15 @@ int main(int argc, char *argv[])
         char *tmp = NULL;
         char *p1  = NULL;
         char *p2  = NULL;
+	
+        /* We don't want to use a form of exec() that searches the
+           PATH, so require that argv[0] be either an absolute or
+           relative path.  Error out if this isn't the case.  */
+        if (strchr(argv[0],'/') == NULL) {
+          log_error("JSVC re-exec requires execution with an absolute or relative path");
+          return(1);
+        }
+
 
         /*
          * There is no need to change LD_LIBRARY_PATH
-- 
1.7.6

